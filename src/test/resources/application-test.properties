# Test Profile Configuration
# Note: spring.profiles.active cannot be set in profile-specific files
# Profile activation is handled via @ActiveProfiles annotation on test classes

# Comprehensive OAuth2 Auto-configuration Exclusions
spring.autoconfigure.exclude=\
  org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration,\
  org.springframework.boot.autoconfigure.security.oauth2.client.OAuth2ClientAutoConfiguration,\
  org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientWebSecurityAutoConfiguration,\
  org.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\
  org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration

# Disable Spanish billing service during testing
thunderfat.spain.billing.enabled=false

# OAuth2 Authorization Server Configuration
# Disable OAuth2 authorization server during testing to avoid bean conflicts
thunderfat.oauth2.authorization-server.enabled=false

# Spring Boot Test Configuration
spring.jpa.hibernate.ddl-auto=create-drop
spring.sql.init.mode=always
spring.sql.init.continue-on-error=true
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.h2.console.enabled=true
spring.jpa.show-sql=false
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# Disable caching completely during tests
spring.cache.type=none

# Logging configuration for tests - reduce verbosity
logging.level.com.thunderfat=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.boot.autoconfigure=ERROR
logging.level.org.hibernate=WARN

# Spanish Certificate Configuration for Tests (Mock/Development)
thunderfat.spain.certificados.keystore-path=./certificates/thunderfat.p12
thunderfat.spain.certificados.keystore-password=changeit
thunderfat.spain.certificados.keystore-type=PKCS12
thunderfat.spain.certificados.certificate-alias=thunderfat-sign

# Spanish Company Configuration for Tests (Mock/Development)
thunderfat.spain.company.nif=12345678A
thunderfat.spain.company.nombre=ThunderFat Test Company S.L.
thunderfat.spain.company.direccion=Calle Test 123
thunderfat.spain.company.codigo-postal=28001
thunderfat.spain.company.poblacion=Madrid

# SpringDoc OpenAPI Configuration for Tests
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true
springdoc.api-docs.enabled=true
thunderfat.spain.company.provincia=Madrid
thunderfat.spain.company.codigo-pais=ES

# Spanish Facturae Configuration for Tests
thunderfat.spain.facturae.version=3.2.2
thunderfat.spain.facturae.output-directory=${java.io.tmpdir}/facturae-test

# Spanish Verifactu Configuration for Tests
thunderfat.spain.verifactu.endpoint=https://www7.aeat.es/wlpl/TIKE-CONT/VerifactuRecepcionFactura
thunderfat.spain.verifactu.test-mode=true